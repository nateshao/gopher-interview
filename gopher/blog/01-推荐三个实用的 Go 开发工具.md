![](https://github.com/yongxinz/gopher/blob/main/blog/pic/01-%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7.png)

**原文链接：** [推荐三个实用的 Go 开发工具](https://mp.weixin.qq.com/s/3GLMLhegB3wF5_62mpmePA)

孙悟空在花果山称王的时候，特意去了一趟东海，在那里淘到了如意金箍棒。因为身为一个山大王，怎么能没有一件趁手的兵器呢？

作为程序员的我们也一样，除了我们的傍身武器 `Ctrl C + V` 之外，还要不停的补充我们的武器库。不仅要把 `Ctrl C + V` 用的高级，更要用的恰到好处。

今天介绍三款小工具，分别可以将 `json`，`yaml` 和 `table` 转成 Go 的 `struct`。下次再碰到这样的转换场景，再也不用皱眉挠头了，一键轻松搞定。

前两个直接在线转换，最后一个需要安装一个库，但也很方便。

### json-to-go

**地址：** https://mholt.github.io/json-to-go/

输入：

```json
[
	{
		"input_index": 0,
		"candidate_index": 0,
		"delivery_line_1": "1 N Rosedale St",
		"components": {
			"primary_number": "1",
			"street_predirection": "N",
			"street_name": "Rosedale",
			"street_suffix": "St",
			"city_name": "Baltimore",
			"state_abbreviation": "MD"
		}
	}
]
```

输出：

```go
type AutoGenerated []struct {
	InputIndex     int    `json:"input_index"`
	CandidateIndex int    `json:"candidate_index"`
	DeliveryLine1  string `json:"delivery_line_1"`
	Components     struct {
		PrimaryNumber      string `json:"primary_number"`
		StreetPredirection string `json:"street_predirection"`
		StreetName         string `json:"street_name"`
		StreetSuffix       string `json:"street_suffix"`
		CityName           string `json:"city_name"`
		StateAbbreviation  string `json:"state_abbreviation"`
	} `json:"components"`
}
```

### yaml-to-go

**地址：** https://zhwt.github.io/yaml-to-go/

输入：

```yaml
image: golang:latest

before_script:
  - mkdir -p $GOPATH/src/$(dirname $REPO_NAME)
  - ln -svf $CI_PROJECT_DIR $GOPATH/src/$REPO_NAME
  - cd $GOPATH/src/$REPO_NAME

stages:
  - test
  - build
  - deploy

format:
  stage: test
  script:
    - go fmt $(go list ./... | grep -v /vendor/)
    - go vet $(go list ./... | grep -v /vendor/)
    - go test -race $(go list ./... | grep -v /vendor/)
```

输出：

```go
type AutoGenerated struct {
	Image        string   `yaml:"image"`
	BeforeScript []string `yaml:"before_script"`
	Stages       []string `yaml:"stages"`
	Format       struct {
		Stage  string   `yaml:"stage"`
		Script []string `yaml:"script"`
	} `yaml:"format"`
}
```

### table-to-go

**地址** https://github.com/gohouse/converter

假设有这样一张表：

```sql
CREATE TABLE `prefix_user` (
  `Id` int(11) NOT NULL AUTO_INCREMENT,
  `Email` varchar(32) NOT NULL DEFAULT '' COMMENT '邮箱',
  `Password` varchar(32) NOT NULL DEFAULT '' COMMENT '密码',
  `CreatedAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`Id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户表'
```

使用方式分两种，分别是命令行调用和写 Go 代码：

#### 命令行调用

1、下载对应平台的可执行文件， 下载地址：https://github.com/gohouse/converter/releases

2、命令行执行：

```
./table2struct-linux.v0.0.3.bin -file model.go -dsn xxx -table user
```

3、参数说明：

```
-dsn            string 数据库dsn配置
-enableJsonTag  bool 是否添加json的tag
-file           string 保存路径
-packageName    string 包名
-prefix         string 表前缀
-realNameMethod string 结构体对应的表名
-table          string 要迁移的表
-tagKey         string tag的key
```

#### Go 代码调用

安装库：

```
go get github.com/gohouse/converter
```

代码：

```go
package main

import (
	"fmt"
	"github.com/gohouse/converter"
)

func main() {
	// 初始化
	t2t := converter.NewTable2Struct()
	// 个性化配置
	t2t.Config(&converter.T2tConfig{
		// 如果字段首字母本来就是大写, 就不添加tag, 默认false添加, true不添加
		RmTagIfUcFirsted: false,
		// tag的字段名字是否转换为小写, 如果本身有大写字母的话, 默认false不转
		TagToLower: false,
		// 字段首字母大写的同时, 是否要把其他字母转换为小写,默认false不转换
		UcFirstOnly: false,
		//// 每个struct放入单独的文件,默认false,放入同一个文件(暂未提供)
		//SeperatFile: false,
	})
	// 开始迁移转换
	err := t2t.
		// 指定某个表,如果不指定,则默认全部表都迁移
		Table("user").
		// 表前缀
		Prefix("prefix_").
		// 是否添加json tag
		EnableJsonTag(true).
		// 生成struct的包名(默认为空的话, 则取名为: package model)
		PackageName("model").
		// tag字段的key值,默认是orm
		TagKey("orm").
		// 是否添加结构体方法获取表名
		RealNameMethod("TableName").
		// 生成的结构体保存路径
		SavePath("/Users/fizz/go/src/github.com/gohouse/gupiao/model/model.go").
		// 数据库dsn,这里可以使用 t2t.DB() 代替,参数为 *sql.DB 对象
		Dsn("root:root@tcp(localhost:3306)/test?charset=utf8").
		// 执行
		Run()
	
	fmt.Println(err)
}
```

输出：

```go
package model

import "time"

type User struct {
	Id         int     `json:"Id" orm:"Id"`
	Email      string  `json:"Email" orm:"Email"`           // 邮箱
	Password   string  `json:"Password" orm:"Password"`     // 密码
	CreatedAt  string  `json:"CreatedAt" orm:"CreatedAt"`
}

func (*User) TableName() string {
	return "user"
}
```

收藏吧！希望你用到的时候还能想起它。

---

文章中的脑图和源码都上传到了 GitHub，有需要的同学可自行下载。

**地址：** https://github.com/yongxinz/gopher/tree/main/blog

关注公众号 **AlwaysBeta**，回复「**goebook**」领取 Go 编程经典书籍。

<center class="half">
    <img src="https://github.com/yongxinz/gopher/blob/main/alwaysbeta.JPG" width="300"/>
</center>

**Go 专栏文章列表：**

1. [开发环境搭建以及开发工具 VS Code 配置](<https://github.com/yongxinz/gopher/blob/main/sc/00-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%20VS%20Code%20%E9%85%8D%E7%BD%AE.md>)

2. [变量和常量的声明与赋值](<https://github.com/yongxinz/gopher/blob/main/sc/01-%E5%8F%98%E9%87%8F%E5%92%8C%E5%B8%B8%E9%87%8F%E7%9A%84%E5%A3%B0%E6%98%8E%E4%B8%8E%E8%B5%8B%E5%80%BC.md>)

3. [基础数据类型：整数、浮点数、复数、布尔值和字符串](<https://github.com/yongxinz/gopher/blob/main/sc/02-%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%EF%BC%9A%E6%95%B4%E6%95%B0%E3%80%81%E6%B5%AE%E7%82%B9%E6%95%B0%E3%80%81%E5%A4%8D%E6%95%B0%E3%80%81%E5%B8%83%E5%B0%94%E5%80%BC%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2.md>)

4. [复合数据类型：数组和切片 slice](<https://github.com/yongxinz/gopher/blob/main/sc/03-%E5%A4%8D%E5%90%88%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%EF%BC%9A%E6%95%B0%E7%BB%84%E5%92%8C%E5%88%87%E7%89%87%20slice.md>)

5. [复合数据类型：字典 map 和 结构体 struct](<https://github.com/yongxinz/gopher/blob/main/sc/04-%E5%A4%8D%E5%90%88%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%EF%BC%9A%E5%AD%97%E5%85%B8%20map%20%E5%92%8C%20%E7%BB%93%E6%9E%84%E4%BD%93%20struct.md>)
6. [流程控制，一网打尽](<https://github.com/yongxinz/gopher/blob/main/sc/05-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%EF%BC%8C%E4%B8%80%E7%BD%91%E6%89%93%E5%B0%BD.md>)
7. [函数那些事](<https://github.com/yongxinz/gopher/blob/main/sc/06-%E5%87%BD%E6%95%B0%E9%82%A3%E4%BA%9B%E4%BA%8B.md>)